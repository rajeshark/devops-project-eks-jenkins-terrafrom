{"ast":null,"code":"import _objectSpread from\"D:/raju new 1/front-end/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _taggedTemplateLiteral from\"D:/raju new 1/front-end/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5;import React,{useState,useEffect,useCallback}from\"react\";import styled from\"styled-components\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{loadStripe}from\"@stripe/stripe-js\";import{Elements,CardNumberElement,CardExpiryElement,CardCvcElement,useStripe,useElements}from\"@stripe/react-stripe-js\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const stripePromise=loadStripe(\"pk_test_51SEWfbGUJ7v3D9GXVs5sPIBEY08wZrpGmeuko8YClRovgbeQkkYJ2NpxLMtM3RyA8v7NSKM4cE8mTLthWafiYGv500lPgVJb3n\");// ... (ALL YOUR EXISTING STYLED COMPONENTS REMAIN EXACTLY THE SAME)\n// Keep all your Container, Wrapper, Title, Top, etc. styled components\n// Add these new styled components for separate card fields\nconst CardFormContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  margin: 20px 0;\\n  text-align: left;\\n\"])));const CardFieldContainer=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  margin-bottom: 15px;\\n\"])));const CardFieldLabel=styled.label(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  display: block;\\n  margin-bottom: 5px;\\n  font-weight: 600;\\n  color: #333;\\n  font-size: 14px;\\n\"])));const CardFieldWrapper=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  padding: 12px;\\n  border: 2px solid #e1e5e9;\\n  border-radius: 8px;\\n  background: white;\\n  transition: border-color 0.3s;\\n  \\n  &:focus-within {\\n    border-color: #4CAF50;\\n    box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.1);\\n  }\\n\"])));const CardRow=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-template-columns: 1fr 1fr;\\n  gap: 15px;\\n  \\n  @media (max-width: 480px) {\\n    grid-template-columns: 1fr;\\n  }\\n\"])));// Improved Stripe Payment Form Component with Separate Fields\nconst StripePaymentForm=_ref=>{let{amount,clientSecret,onSuccess,onError}=_ref;const stripe=useStripe();const elements=useElements();const[processing,setProcessing]=useState(false);const[error,setError]=useState('');const handleSubmit=async event=>{event.preventDefault();if(!stripe||!elements){return;}setProcessing(true);setError('');try{const cardNumber=elements.getElement(CardNumberElement);const cardExpiry=elements.getElement(CardExpiryElement);const cardCvc=elements.getElement(CardCvcElement);// Create payment method with separate elements\nconst{error:stripeError,paymentMethod}=await stripe.createPaymentMethod({type:'card',card:cardNumber,billing_details:{// You can add billing details here if needed\n}});if(stripeError){setError(stripeError.message);onError(stripeError.message);return;}// Confirm payment with the payment method\nconst{error:confirmError,paymentIntent}=await stripe.confirmCardPayment(clientSecret,{payment_method:paymentMethod.id});if(confirmError){setError(confirmError.message);onError(confirmError.message);}else if(paymentIntent.status==='succeeded'){onSuccess(paymentIntent);}}catch(err){setError('Payment failed. Please try again.');onError(err.message);}finally{setProcessing(false);}};// Styling for individual card elements\nconst cardElementOptions={style:{base:{fontSize:'16px',color:'#424770',fontFamily:'\"Helvetica Neue\", Helvetica, sans-serif','::placeholder':{color:'#aab7c4'},backgroundColor:'transparent'},invalid:{color:'#9e2146',iconColor:'#9e2146'}}};return/*#__PURE__*/_jsxs(CardFormContainer,{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'15px',color:'#333'},children:\"Payment Details\"}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:'18px',fontWeight:'600',color:'#2c5aa0',marginBottom:'20px'},children:[\"Total Amount: \",/*#__PURE__*/_jsxs(\"span\",{style:{color:'#4CAF50'},children:[\"$\",amount]})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(CardFieldContainer,{children:[/*#__PURE__*/_jsx(CardFieldLabel,{children:\"Card Number\"}),/*#__PURE__*/_jsx(CardFieldWrapper,{children:/*#__PURE__*/_jsx(CardNumberElement,{options:_objectSpread(_objectSpread({},cardElementOptions),{},{placeholder:'1234 1234 1234 1234'})})})]}),/*#__PURE__*/_jsxs(CardRow,{children:[/*#__PURE__*/_jsxs(CardFieldContainer,{children:[/*#__PURE__*/_jsx(CardFieldLabel,{children:\"Expiry Date\"}),/*#__PURE__*/_jsx(CardFieldWrapper,{children:/*#__PURE__*/_jsx(CardExpiryElement,{options:_objectSpread(_objectSpread({},cardElementOptions),{},{placeholder:'MM/YY'})})})]}),/*#__PURE__*/_jsxs(CardFieldContainer,{children:[/*#__PURE__*/_jsx(CardFieldLabel,{children:\"CVC\"}),/*#__PURE__*/_jsx(CardFieldWrapper,{children:/*#__PURE__*/_jsx(CardCvcElement,{options:_objectSpread(_objectSpread({},cardElementOptions),{},{placeholder:'123'})})})]})]}),error&&/*#__PURE__*/_jsxs(ErrorMessage,{style:{textAlign:'left'},children:[\"\\u26A0\\uFE0F \",error]}),/*#__PURE__*/_jsx(PayNowBtn,{type:\"submit\",disabled:!stripe||processing,children:processing?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{style:{marginRight:'8px'},children:\"\\u23F3\"}),\"Processing Payment...\"]}):\"Pay $\".concat(amount)})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'20px',padding:'15px',background:'#f8f9fa',borderRadius:'8px',fontSize:'13px',textAlign:'left',border:'1px solid #e9ecef'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0 0 10px 0',color:'#495057',fontSize:'14px'},children:\"\\uD83E\\uDDEA Test Card Information\"}),/*#__PURE__*/_jsxs(\"div\",{style:{lineHeight:'1.6',color:'#6c757d'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Card Number:\"}),\" 4242 4242 4242 4242\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Expiry Date:\"}),\" 12/34\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"CVC:\"}),\" 123\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"ZIP Code:\"}),\" 12345\"]})]})]})]});};// Main CartPage Component (REMAINS EXACTLY THE SAME AS BEFORE)\nconst CartPage=()=>{const[cartItems,setCartItems]=useState([]);const[loading,setLoading]=useState(false);const[isCheckingOut,setIsCheckingOut]=useState(false);const[showAddressForm,setShowAddressForm]=useState(false);const[showPayment,setShowPayment]=useState(false);const[paymentError,setPaymentError]=useState('');const[clientSecret,setClientSecret]=useState('');const[currentOrderId,setCurrentOrderId]=useState('');const navigate=useNavigate();const[address,setAddress]=useState({street:\"\",city:\"\",state:\"\",zipCode:\"\",country:\"\"});// Define functions at the top\nconst getAuthHeader=()=>{const token=localStorage.getItem('token');return token?{Authorization:\"Bearer \".concat(token)}:{};};const getCurrentUser=()=>{const token=localStorage.getItem('token');if(token){try{const base64Payload=token.split('.')[1];const payload=JSON.parse(atob(base64Payload));return payload.userId;}catch(error){return null;}}return null;};const calculateShipping=()=>{const subtotal=getTotal();if(subtotal>=50){return{shipping:0,hasFreeShipping:true};}else{return{shipping:5.90,hasFreeShipping:false};}};const getTotal=()=>{return cartItems.reduce((total,item)=>total+parseFloat(item.price)*item.quantity,0);};const getFinalTotal=()=>{const shippingInfo=calculateShipping();return getTotal()+shippingInfo.shipping;};const fetchCart=useCallback(async()=>{const userId=getCurrentUser();if(!userId){setCartItems([]);return;}try{setLoading(true);const response=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/cart/\").concat(userId),{headers:getAuthHeader()});setCartItems(response.data);}catch(error){console.error('Error fetching cart:',error);}finally{setLoading(false);}},[]);const updateCartItem=async(productId,quantity)=>{const userId=getCurrentUser();if(!userId)return;try{await axios.put(\"\".concat(process.env.REACT_APP_API_URL,\"/api/cart/\").concat(userId),{productId,quantity},{headers:getAuthHeader()});await fetchCart();}catch(error){console.error('Error updating cart:',error);}};const removeFromCart=async productId=>{const userId=getCurrentUser();if(!userId)return;try{await axios.delete(\"\".concat(process.env.REACT_APP_API_URL,\"/api/cart/\").concat(userId,\"/\").concat(productId),{headers:getAuthHeader()});await fetchCart();}catch(error){console.error('Error removing from cart:',error);}};useEffect(()=>{fetchCart();},[fetchCart]);const handleQuantity=(productId,quantity)=>{if(quantity===0){removeFromCart(productId);}else{updateCartItem(productId,quantity);}};const handlePayment=async()=>{setPaymentError('');setIsCheckingOut(true);try{const userId=getCurrentUser();const token=localStorage.getItem('token');const BASE_URL=process.env.REACT_APP_API_URL;console.log('Using base URL:',BASE_URL);// 1. CREATE THE ORDER FIRST\nconst orderData={cartItems:cartItems.map(item=>({productId:item.productId,title:item.title,price:item.price,quantity:item.quantity,size:item.size||'One Size',color:item.color||'Default',img:item.img})),address:address,totalAmount:getFinalTotal()};console.log('Creating order with data:',orderData);const orderResponse=await axios.post(\"\".concat(BASE_URL,\"/api/orders\"),orderData,{headers:{Authorization:\"Bearer \".concat(token),'Content-Type':'application/json'}});console.log('Order created:',orderResponse.data);const createdOrderId=orderResponse.data.order.id;setCurrentOrderId(createdOrderId);const amount=Math.round(getFinalTotal()*100);// Convert to cents\nconsole.log('Creating payment intent for amount:',amount,'Order ID:',createdOrderId);// 2. CREATE PAYMENT INTENT WITH STRIPE\nconst paymentResponse=await axios.post(\"\".concat(BASE_URL,\"/api/payments/create-payment-intent\"),{orderId:createdOrderId,amount:amount},{headers:{Authorization:\"Bearer \".concat(token),'Content-Type':'application/json'},timeout:10000});console.log('Payment intent created:',paymentResponse.data);if(paymentResponse.data.clientSecret){setClientSecret(paymentResponse.data.clientSecret);}else{throw new Error('No client secret received from payment service');}}catch(error){var _error$response,_error$response$data;console.error('Payment setup error:',error);setPaymentError(\"Payment setup failed: \".concat(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||error.message));setIsCheckingOut(false);}};const handlePaymentSuccess=async paymentIntent=>{try{const userId=getCurrentUser();const token=localStorage.getItem('token');const BASE_URL=process.env.REACT_APP_API_URL;console.log('Stripe payment succeeded:',paymentIntent);// Confirm payment with your backend\nawait axios.post(\"\".concat(BASE_URL,\"/api/payments/confirm-payment\"),{paymentIntentId:paymentIntent.id},{headers:{Authorization:\"Bearer \".concat(token)}});// Clear cart after successful payment\ntry{await axios.delete(\"\".concat(BASE_URL,\"/api/cart/\").concat(userId,\"/clear\"),{headers:{Authorization:\"Bearer \".concat(token)}});console.log('Cart cleared successfully');}catch(cartError){console.log('Cart clearing failed, but continuing...',cartError);}// Clear cart locally\nsetCartItems([]);// Show success and redirect\nalert(\"Payment successful! Order ID: \".concat(currentOrderId));setShowPayment(false);setClientSecret('');navigate('/success');}catch(error){console.error('Post-payment processing error:',error);}};const handlePaymentError=errorMessage=>{setPaymentError(\"Payment failed: \".concat(errorMessage));};const handleCheckout=()=>{if(cartItems.length===0){alert('Your cart is empty');return;}const token=localStorage.getItem('token');if(!token){alert('Please login to checkout');navigate('/login');return;}if(!showAddressForm){setShowAddressForm(true);return;}if(!address.street||!address.city||!address.state||!address.zipCode||!address.country){alert('Please fill in all address fields');return;}setShowPayment(true);};const handleInputChange=e=>{const{name,value}=e.target;setAddress(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));};const handleContinueShopping=()=>{navigate('/');};const shippingInfo=calculateShipping();if(loading){return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Wrapper,{children:[/*#__PURE__*/_jsx(Title,{children:\"YOUR BAG\"}),/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'50px'},children:\"Loading cart...\"})]})});}return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsxs(Wrapper,{children:[/*#__PURE__*/_jsx(Title,{children:\"YOUR BAG\"}),/*#__PURE__*/_jsxs(Top,{children:[/*#__PURE__*/_jsx(TopButton,{onClick:handleContinueShopping,children:\"CONTINUE SHOPPING\"}),/*#__PURE__*/_jsxs(TopTexts,{children:[/*#__PURE__*/_jsxs(TopText,{children:[\"Shopping Bag(\",cartItems.length,\")\"]}),/*#__PURE__*/_jsx(TopText,{children:\"Your Wishlist (0)\"})]}),/*#__PURE__*/_jsx(TopButton,{type:\"filled\",onClick:handleCheckout,disabled:cartItems.length===0,children:isCheckingOut?'PROCESSING...':'CHECKOUT NOW'})]}),/*#__PURE__*/_jsxs(Bottom,{children:[/*#__PURE__*/_jsx(Info,{children:cartItems.length===0?/*#__PURE__*/_jsxs(EmptyCart,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Your cart is empty\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Add some products to your cart to see them here\"}),/*#__PURE__*/_jsx(TopButton,{onClick:handleContinueShopping,style:{marginTop:'20px'},children:\"START SHOPPING\"})]}):cartItems.map(item=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Product,{children:[/*#__PURE__*/_jsxs(ProductDetail,{children:[/*#__PURE__*/_jsx(Image,{src:item.img||'https://via.placeholder.com/200x200?text=No+Image'}),/*#__PURE__*/_jsxs(Details,{children:[/*#__PURE__*/_jsxs(ProductName,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Product:\"}),\" \",item.title]}),/*#__PURE__*/_jsxs(ProductId,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"ID:\"}),\" \",item.productId]}),item.size&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Size:\"}),\" \",item.size]}),item.color&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Color:\"}),\" \",item.color]})]})]}),/*#__PURE__*/_jsxs(PriceDetail,{children:[/*#__PURE__*/_jsxs(ProductAmountContainer,{children:[/*#__PURE__*/_jsx(QuantityButton,{onClick:()=>handleQuantity(item.productId,item.quantity-1),children:\"-\"}),/*#__PURE__*/_jsx(ProductAmount,{children:item.quantity}),/*#__PURE__*/_jsx(QuantityButton,{onClick:()=>handleQuantity(item.productId,item.quantity+1),children:\"+\"})]}),/*#__PURE__*/_jsxs(ProductPrice,{children:[\"$ \",(parseFloat(item.price)*item.quantity).toFixed(2)]})]})]}),/*#__PURE__*/_jsx(Hr,{})]},item.id))}),cartItems.length>0&&/*#__PURE__*/_jsxs(Summary,{children:[/*#__PURE__*/_jsx(SummaryTitle,{children:\"ORDER SUMMARY\"}),/*#__PURE__*/_jsxs(SummaryItem,{children:[/*#__PURE__*/_jsx(SummaryItemText,{children:\"Subtotal\"}),/*#__PURE__*/_jsxs(SummaryItemPrice,{children:[\"$ \",getTotal().toFixed(2)]})]}),/*#__PURE__*/_jsxs(SummaryItem,{children:[/*#__PURE__*/_jsxs(SummaryItemText,{children:[\"Shipping\",shippingInfo.hasFreeShipping&&/*#__PURE__*/_jsx(FreeShippingBadge,{children:\"\\uD83D\\uDE9A FREE\"})]}),/*#__PURE__*/_jsx(SummaryItemPrice,{children:shippingInfo.hasFreeShipping?'$ 0.00':\"$ \".concat(shippingInfo.shipping.toFixed(2))})]}),!shippingInfo.hasFreeShipping&&/*#__PURE__*/_jsxs(SummaryItem,{children:[/*#__PURE__*/_jsxs(SummaryItemText,{style:{fontSize:'12px',color:'#666',fontStyle:'italic'},children:[\"Add $\",(50-getTotal()).toFixed(2),\" more for free shipping!\"]}),/*#__PURE__*/_jsx(SummaryItemPrice,{})]}),/*#__PURE__*/_jsxs(SummaryItem,{type:\"total\",children:[/*#__PURE__*/_jsx(SummaryItemText,{children:\"Total\"}),/*#__PURE__*/_jsxs(SummaryItemPrice,{children:[\"$ \",getFinalTotal().toFixed(2)]})]}),showAddressForm&&/*#__PURE__*/_jsxs(AddressForm,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Shipping Address\"}),/*#__PURE__*/_jsx(Input,{type:\"text\",name:\"street\",placeholder:\"Street Address\",value:address.street,onChange:handleInputChange,required:true}),/*#__PURE__*/_jsxs(InputRow,{children:[/*#__PURE__*/_jsx(InputGroup,{children:/*#__PURE__*/_jsx(Input,{type:\"text\",name:\"city\",placeholder:\"City\",value:address.city,onChange:handleInputChange,required:true})}),/*#__PURE__*/_jsx(InputGroup,{children:/*#__PURE__*/_jsx(Input,{type:\"text\",name:\"state\",placeholder:\"State\",value:address.state,onChange:handleInputChange,required:true})})]}),/*#__PURE__*/_jsxs(InputRow,{children:[/*#__PURE__*/_jsx(InputGroup,{children:/*#__PURE__*/_jsx(Input,{type:\"text\",name:\"zipCode\",placeholder:\"ZIP Code\",value:address.zipCode,onChange:handleInputChange,required:true})}),/*#__PURE__*/_jsx(InputGroup,{children:/*#__PURE__*/_jsx(Input,{type:\"text\",name:\"country\",placeholder:\"Country\",value:address.country,onChange:handleInputChange,required:true})})]})]}),/*#__PURE__*/_jsx(Button,{onClick:handleCheckout,disabled:cartItems.length===0||isCheckingOut,children:isCheckingOut?'PROCESSING ORDER...':showAddressForm?'PROCEED TO PAYMENT':\"CHECKOUT NOW ($\".concat(getFinalTotal().toFixed(2),\")\")})]})]})]}),showPayment&&/*#__PURE__*/_jsx(PaymentModal,{children:/*#__PURE__*/_jsxs(PaymentContent,{children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginBottom:'10px',color:'#333'},children:\"Complete Your Purchase\"}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:'18px',fontWeight:'600',color:'#2c5aa0',marginBottom:'20px'},children:[\"Total Amount: \",/*#__PURE__*/_jsxs(\"span\",{style:{color:'#4CAF50'},children:[\"$\",getFinalTotal().toFixed(2)]})]}),paymentError&&/*#__PURE__*/_jsx(ErrorMessage,{children:paymentError}),clientSecret?/*#__PURE__*/_jsx(Elements,{stripe:stripePromise,options:{clientSecret},children:/*#__PURE__*/_jsx(StripePaymentForm,{amount:getFinalTotal().toFixed(2),clientSecret:clientSecret,onSuccess:handlePaymentSuccess,onError:handlePaymentError})}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(PayNowBtn,{onClick:handlePayment,disabled:isCheckingOut,children:isCheckingOut?'Setting Up Payment...':'Proceed to Payment'})}),/*#__PURE__*/_jsx(CancelBtn,{onClick:()=>{setShowPayment(false);setClientSecret('');setPaymentError('');},children:\"Cancel Payment\"})]})})]});};export default CartPage;","map":{"version":3,"names":["React","useState","useEffect","useCallback","styled","axios","useNavigate","loadStripe","Elements","CardNumberElement","CardExpiryElement","CardCvcElement","useStripe","useElements","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","stripePromise","CardFormContainer","div","_templateObject","_taggedTemplateLiteral","CardFieldContainer","_templateObject2","CardFieldLabel","label","_templateObject3","CardFieldWrapper","_templateObject4","CardRow","_templateObject5","StripePaymentForm","_ref","amount","clientSecret","onSuccess","onError","stripe","elements","processing","setProcessing","error","setError","handleSubmit","event","preventDefault","cardNumber","getElement","cardExpiry","cardCvc","stripeError","paymentMethod","createPaymentMethod","type","card","billing_details","message","confirmError","paymentIntent","confirmCardPayment","payment_method","id","status","err","cardElementOptions","style","base","fontSize","color","fontFamily","backgroundColor","invalid","iconColor","children","marginBottom","fontWeight","onSubmit","options","_objectSpread","placeholder","ErrorMessage","textAlign","PayNowBtn","disabled","marginRight","concat","marginTop","padding","background","borderRadius","border","margin","lineHeight","CartPage","cartItems","setCartItems","loading","setLoading","isCheckingOut","setIsCheckingOut","showAddressForm","setShowAddressForm","showPayment","setShowPayment","paymentError","setPaymentError","setClientSecret","currentOrderId","setCurrentOrderId","navigate","address","setAddress","street","city","state","zipCode","country","getAuthHeader","token","localStorage","getItem","Authorization","getCurrentUser","base64Payload","split","payload","JSON","parse","atob","userId","calculateShipping","subtotal","getTotal","shipping","hasFreeShipping","reduce","total","item","parseFloat","price","quantity","getFinalTotal","shippingInfo","fetchCart","response","get","process","env","REACT_APP_API_URL","headers","data","console","updateCartItem","productId","put","removeFromCart","delete","handleQuantity","handlePayment","BASE_URL","log","orderData","map","title","size","img","totalAmount","orderResponse","post","createdOrderId","order","Math","round","paymentResponse","orderId","timeout","Error","_error$response","_error$response$data","handlePaymentSuccess","paymentIntentId","cartError","alert","handlePaymentError","errorMessage","handleCheckout","length","handleInputChange","e","name","value","target","prev","handleContinueShopping","Container","Wrapper","Title","Top","TopButton","onClick","TopTexts","TopText","Bottom","Info","EmptyCart","Product","ProductDetail","Image","src","Details","ProductName","ProductId","PriceDetail","ProductAmountContainer","QuantityButton","ProductAmount","ProductPrice","toFixed","Hr","Summary","SummaryTitle","SummaryItem","SummaryItemText","SummaryItemPrice","FreeShippingBadge","fontStyle","AddressForm","Input","onChange","required","InputRow","InputGroup","Button","PaymentModal","PaymentContent","CancelBtn"],"sources":["D:/raju new 1/front-end/src/pages/CartPage.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport axios from \"axios\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { loadStripe } from \"@stripe/stripe-js\";\r\nimport { \r\n  Elements, \r\n  CardNumberElement, \r\n  CardExpiryElement, \r\n  CardCvcElement, \r\n  useStripe, \r\n  useElements \r\n} from \"@stripe/react-stripe-js\";\r\n\r\nconst stripePromise = loadStripe(\"pk_test_51SEWfbGUJ7v3D9GXVs5sPIBEY08wZrpGmeuko8YClRovgbeQkkYJ2NpxLMtM3RyA8v7NSKM4cE8mTLthWafiYGv500lPgVJb3n\");\r\n\r\n// ... (ALL YOUR EXISTING STYLED COMPONENTS REMAIN EXACTLY THE SAME)\r\n// Keep all your Container, Wrapper, Title, Top, etc. styled components\r\n\r\n// Add these new styled components for separate card fields\r\nconst CardFormContainer = styled.div`\r\n  margin: 20px 0;\r\n  text-align: left;\r\n`;\r\n\r\nconst CardFieldContainer = styled.div`\r\n  margin-bottom: 15px;\r\n`;\r\n\r\nconst CardFieldLabel = styled.label`\r\n  display: block;\r\n  margin-bottom: 5px;\r\n  font-weight: 600;\r\n  color: #333;\r\n  font-size: 14px;\r\n`;\r\n\r\nconst CardFieldWrapper = styled.div`\r\n  padding: 12px;\r\n  border: 2px solid #e1e5e9;\r\n  border-radius: 8px;\r\n  background: white;\r\n  transition: border-color 0.3s;\r\n  \r\n  &:focus-within {\r\n    border-color: #4CAF50;\r\n    box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.1);\r\n  }\r\n`;\r\n\r\nconst CardRow = styled.div`\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr;\r\n  gap: 15px;\r\n  \r\n  @media (max-width: 480px) {\r\n    grid-template-columns: 1fr;\r\n  }\r\n`;\r\n\r\n// Improved Stripe Payment Form Component with Separate Fields\r\nconst StripePaymentForm = ({ amount, clientSecret, onSuccess, onError }) => {\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n  const [processing, setProcessing] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n    \r\n    if (!stripe || !elements) {\r\n      return;\r\n    }\r\n\r\n    setProcessing(true);\r\n    setError('');\r\n\r\n    try {\r\n      const cardNumber = elements.getElement(CardNumberElement);\r\n      const cardExpiry = elements.getElement(CardExpiryElement);\r\n      const cardCvc = elements.getElement(CardCvcElement);\r\n\r\n      // Create payment method with separate elements\r\n      const { error: stripeError, paymentMethod } = await stripe.createPaymentMethod({\r\n        type: 'card',\r\n        card: cardNumber,\r\n        billing_details: {\r\n          // You can add billing details here if needed\r\n        },\r\n      });\r\n\r\n      if (stripeError) {\r\n        setError(stripeError.message);\r\n        onError(stripeError.message);\r\n        return;\r\n      }\r\n\r\n      // Confirm payment with the payment method\r\n      const { error: confirmError, paymentIntent } = await stripe.confirmCardPayment(clientSecret, {\r\n        payment_method: paymentMethod.id,\r\n      });\r\n\r\n      if (confirmError) {\r\n        setError(confirmError.message);\r\n        onError(confirmError.message);\r\n      } else if (paymentIntent.status === 'succeeded') {\r\n        onSuccess(paymentIntent);\r\n      }\r\n    } catch (err) {\r\n      setError('Payment failed. Please try again.');\r\n      onError(err.message);\r\n    } finally {\r\n      setProcessing(false);\r\n    }\r\n  };\r\n\r\n  // Styling for individual card elements\r\n  const cardElementOptions = {\r\n    style: {\r\n      base: {\r\n        fontSize: '16px',\r\n        color: '#424770',\r\n        fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\r\n        '::placeholder': {\r\n          color: '#aab7c4',\r\n        },\r\n        backgroundColor: 'transparent',\r\n      },\r\n      invalid: {\r\n        color: '#9e2146',\r\n        iconColor: '#9e2146',\r\n      },\r\n    },\r\n  };\r\n\r\n  return (\r\n    <CardFormContainer>\r\n      <h3 style={{ marginBottom: '15px', color: '#333' }}>Payment Details</h3>\r\n      <p style={{ fontSize: '18px', fontWeight: '600', color: '#2c5aa0', marginBottom: '20px' }}>\r\n        Total Amount: <span style={{ color: '#4CAF50' }}>${amount}</span>\r\n      </p>\r\n      \r\n      <form onSubmit={handleSubmit}>\r\n        {/* Card Number Field */}\r\n        <CardFieldContainer>\r\n          <CardFieldLabel>Card Number</CardFieldLabel>\r\n          <CardFieldWrapper>\r\n            <CardNumberElement\r\n              options={{\r\n                ...cardElementOptions,\r\n                placeholder: '1234 1234 1234 1234',\r\n              }}\r\n            />\r\n          </CardFieldWrapper>\r\n        </CardFieldContainer>\r\n\r\n        {/* Expiry and CVC in one row */}\r\n        <CardRow>\r\n          <CardFieldContainer>\r\n            <CardFieldLabel>Expiry Date</CardFieldLabel>\r\n            <CardFieldWrapper>\r\n              <CardExpiryElement\r\n                options={{\r\n                  ...cardElementOptions,\r\n                  placeholder: 'MM/YY',\r\n                }}\r\n              />\r\n            </CardFieldWrapper>\r\n          </CardFieldContainer>\r\n\r\n          <CardFieldContainer>\r\n            <CardFieldLabel>CVC</CardFieldLabel>\r\n            <CardFieldWrapper>\r\n              <CardCvcElement\r\n                options={{\r\n                  ...cardElementOptions,\r\n                  placeholder: '123',\r\n                }}\r\n              />\r\n            </CardFieldWrapper>\r\n          </CardFieldContainer>\r\n        </CardRow>\r\n        \r\n        {error && (\r\n          <ErrorMessage style={{ textAlign: 'left' }}>\r\n            ‚ö†Ô∏è {error}\r\n          </ErrorMessage>\r\n        )}\r\n        \r\n        <PayNowBtn type=\"submit\" disabled={!stripe || processing}>\r\n          {processing ? (\r\n            <>\r\n              <span style={{ marginRight: '8px' }}>‚è≥</span>\r\n              Processing Payment...\r\n            </>\r\n          ) : (\r\n            `Pay $${amount}`\r\n          )}\r\n        </PayNowBtn>\r\n      </form>\r\n\r\n      {/* Test Card Info - Better Styled */}\r\n      <div style={{ \r\n        marginTop: '20px', \r\n        padding: '15px', \r\n        background: '#f8f9fa', \r\n        borderRadius: '8px', \r\n        fontSize: '13px',\r\n        textAlign: 'left',\r\n        border: '1px solid #e9ecef'\r\n      }}>\r\n        <h4 style={{ margin: '0 0 10px 0', color: '#495057', fontSize: '14px' }}>\r\n          üß™ Test Card Information\r\n        </h4>\r\n        <div style={{ lineHeight: '1.6', color: '#6c757d' }}>\r\n          <div><strong>Card Number:</strong> 4242 4242 4242 4242</div>\r\n          <div><strong>Expiry Date:</strong> 12/34</div>\r\n          <div><strong>CVC:</strong> 123</div>\r\n          <div><strong>ZIP Code:</strong> 12345</div>\r\n        </div>\r\n      </div>\r\n    </CardFormContainer>\r\n  );\r\n};\r\n\r\n// Main CartPage Component (REMAINS EXACTLY THE SAME AS BEFORE)\r\nconst CartPage = () => {\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [isCheckingOut, setIsCheckingOut] = useState(false);\r\n  const [showAddressForm, setShowAddressForm] = useState(false);\r\n  const [showPayment, setShowPayment] = useState(false);\r\n  const [paymentError, setPaymentError] = useState('');\r\n  const [clientSecret, setClientSecret] = useState('');\r\n  const [currentOrderId, setCurrentOrderId] = useState('');\r\n  const navigate = useNavigate();\r\n\r\n  const [address, setAddress] = useState({\r\n    street: \"\",\r\n    city: \"\",\r\n    state: \"\",\r\n    zipCode: \"\",\r\n    country: \"\"\r\n  });\r\n\r\n  // Define functions at the top\r\n  const getAuthHeader = () => {\r\n    const token = localStorage.getItem('token');\r\n    return token ? { Authorization: `Bearer ${token}` } : {};\r\n  };\r\n\r\n  const getCurrentUser = () => {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      try {\r\n        const base64Payload = token.split('.')[1];\r\n        const payload = JSON.parse(atob(base64Payload));\r\n        return payload.userId;\r\n      } catch (error) {\r\n        return null;\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const calculateShipping = () => {\r\n    const subtotal = getTotal();\r\n    if (subtotal >= 50) {\r\n      return { shipping: 0, hasFreeShipping: true };\r\n    } else {\r\n      return { shipping: 5.90, hasFreeShipping: false };\r\n    }\r\n  };\r\n\r\n  const getTotal = () => {\r\n    return cartItems.reduce((total, item) => total + parseFloat(item.price) * item.quantity, 0);\r\n  };\r\n\r\n  const getFinalTotal = () => {\r\n    const shippingInfo = calculateShipping();\r\n    return getTotal() + shippingInfo.shipping;\r\n  };\r\n\r\n  const fetchCart = useCallback(async () => {\r\n    const userId = getCurrentUser();\r\n    if (!userId) {\r\n      setCartItems([]);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      const response = await axios.get(\r\n        `${process.env.REACT_APP_API_URL}/api/cart/${userId}`,\r\n        { headers: getAuthHeader() }\r\n      );\r\n      setCartItems(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching cart:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const updateCartItem = async (productId, quantity) => {\r\n    const userId = getCurrentUser();\r\n    if (!userId) return;\r\n\r\n    try {\r\n      await axios.put(\r\n        `${process.env.REACT_APP_API_URL}/api/cart/${userId}`,\r\n        { productId, quantity },\r\n        { headers: getAuthHeader() }\r\n      );\r\n      await fetchCart();\r\n    } catch (error) {\r\n      console.error('Error updating cart:', error);\r\n    }\r\n  };\r\n\r\n  const removeFromCart = async (productId) => {\r\n    const userId = getCurrentUser();\r\n    if (!userId) return;\r\n\r\n    try {\r\n      await axios.delete(\r\n        `${process.env.REACT_APP_API_URL}/api/cart/${userId}/${productId}`,\r\n        { headers: getAuthHeader() }\r\n      );\r\n      await fetchCart();\r\n    } catch (error) {\r\n      console.error('Error removing from cart:', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchCart();\r\n  }, [fetchCart]);\r\n\r\n  const handleQuantity = (productId, quantity) => {\r\n    if (quantity === 0) {\r\n      removeFromCart(productId);\r\n    } else {\r\n      updateCartItem(productId, quantity);\r\n    }\r\n  };\r\n\r\n  const handlePayment = async () => {\r\n    setPaymentError('');\r\n    setIsCheckingOut(true);\r\n\r\n    try {\r\n      const userId = getCurrentUser();\r\n      const token = localStorage.getItem('token');\r\n      \r\n      const BASE_URL = process.env.REACT_APP_API_URL;\r\n      console.log('Using base URL:', BASE_URL);\r\n\r\n      // 1. CREATE THE ORDER FIRST\r\n      const orderData = {\r\n        cartItems: cartItems.map(item => ({\r\n          productId: item.productId,\r\n          title: item.title,\r\n          price: item.price,\r\n          quantity: item.quantity,\r\n          size: item.size || 'One Size',\r\n          color: item.color || 'Default',\r\n          img: item.img\r\n        })),\r\n        address: address,\r\n        totalAmount: getFinalTotal()\r\n      };\r\n\r\n      console.log('Creating order with data:', orderData);\r\n\r\n      const orderResponse = await axios.post(\r\n        `${BASE_URL}/api/orders`,\r\n        orderData,\r\n        { \r\n          headers: { \r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'application/json'\r\n          }\r\n        }\r\n      );\r\n\r\n      console.log('Order created:', orderResponse.data);\r\n      const createdOrderId = orderResponse.data.order.id;\r\n      setCurrentOrderId(createdOrderId);\r\n\r\n      const amount = Math.round(getFinalTotal() * 100); // Convert to cents\r\n\r\n      console.log('Creating payment intent for amount:', amount, 'Order ID:', createdOrderId);\r\n\r\n      // 2. CREATE PAYMENT INTENT WITH STRIPE\r\n      const paymentResponse = await axios.post(\r\n        `${BASE_URL}/api/payments/create-payment-intent`,\r\n        { \r\n          orderId: createdOrderId,\r\n          amount: amount\r\n        },\r\n        { \r\n          headers: { \r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'application/json'\r\n          },\r\n          timeout: 10000\r\n        }\r\n      );\r\n\r\n      console.log('Payment intent created:', paymentResponse.data);\r\n\r\n      if (paymentResponse.data.clientSecret) {\r\n        setClientSecret(paymentResponse.data.clientSecret);\r\n      } else {\r\n        throw new Error('No client secret received from payment service');\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Payment setup error:', error);\r\n      setPaymentError(`Payment setup failed: ${error.response?.data?.error || error.message}`);\r\n      setIsCheckingOut(false);\r\n    }\r\n  };\r\n\r\n  const handlePaymentSuccess = async (paymentIntent) => {\r\n    try {\r\n      const userId = getCurrentUser();\r\n      const token = localStorage.getItem('token');\r\n      const BASE_URL = process.env.REACT_APP_API_URL;\r\n\r\n      console.log('Stripe payment succeeded:', paymentIntent);\r\n\r\n      // Confirm payment with your backend\r\n      await axios.post(\r\n        `${BASE_URL}/api/payments/confirm-payment`,\r\n        { paymentIntentId: paymentIntent.id },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n\r\n      // Clear cart after successful payment\r\n      try {\r\n        await axios.delete(\r\n          `${BASE_URL}/api/cart/${userId}/clear`,\r\n          { headers: { Authorization: `Bearer ${token}` } }\r\n        );\r\n        console.log('Cart cleared successfully');\r\n      } catch (cartError) {\r\n        console.log('Cart clearing failed, but continuing...', cartError);\r\n      }\r\n\r\n      // Clear cart locally\r\n      setCartItems([]);\r\n\r\n      // Show success and redirect\r\n      alert(`Payment successful! Order ID: ${currentOrderId}`);\r\n      setShowPayment(false);\r\n      setClientSecret('');\r\n      navigate('/success');\r\n\r\n    } catch (error) {\r\n      console.error('Post-payment processing error:', error);\r\n    }\r\n  };\r\n\r\n  const handlePaymentError = (errorMessage) => {\r\n    setPaymentError(`Payment failed: ${errorMessage}`);\r\n  };\r\n\r\n  const handleCheckout = () => {\r\n    if (cartItems.length === 0) {\r\n      alert('Your cart is empty');\r\n      return;\r\n    }\r\n    \r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      alert('Please login to checkout');\r\n      navigate('/login');\r\n      return;\r\n    }\r\n\r\n    if (!showAddressForm) {\r\n      setShowAddressForm(true);\r\n      return;\r\n    }\r\n\r\n    if (!address.street || !address.city || !address.state || !address.zipCode || !address.country) {\r\n      alert('Please fill in all address fields');\r\n      return;\r\n    }\r\n\r\n    setShowPayment(true);\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setAddress(prev => ({\r\n      ...prev,\r\n      [name]: value\r\n    }));\r\n  };\r\n\r\n  const handleContinueShopping = () => {\r\n    navigate('/');\r\n  };\r\n\r\n  const shippingInfo = calculateShipping();\r\n\r\n  if (loading) {\r\n    return (\r\n      <Container>\r\n        <Wrapper>\r\n          <Title>YOUR BAG</Title>\r\n          <div style={{ textAlign: 'center', padding: '50px' }}>Loading cart...</div>\r\n        </Wrapper>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      <Wrapper>\r\n        <Title>YOUR BAG</Title>\r\n        <Top>\r\n          <TopButton onClick={handleContinueShopping}>CONTINUE SHOPPING</TopButton>\r\n          <TopTexts>\r\n            <TopText>Shopping Bag({cartItems.length})</TopText>\r\n            <TopText>Your Wishlist (0)</TopText>\r\n          </TopTexts>\r\n          <TopButton \r\n            type=\"filled\" \r\n            onClick={handleCheckout}\r\n            disabled={cartItems.length === 0}\r\n          >\r\n            {isCheckingOut ? 'PROCESSING...' : 'CHECKOUT NOW'}\r\n          </TopButton>\r\n        </Top>\r\n        <Bottom>\r\n          <Info>\r\n            {cartItems.length === 0 ? (\r\n              <EmptyCart>\r\n                <h3>Your cart is empty</h3>\r\n                <p>Add some products to your cart to see them here</p>\r\n                <TopButton onClick={handleContinueShopping} style={{ marginTop: '20px' }}>\r\n                  START SHOPPING\r\n                </TopButton>\r\n              </EmptyCart>\r\n            ) : (\r\n              cartItems.map((item) => (\r\n                <div key={item.id}>\r\n                  <Product>\r\n                    <ProductDetail>\r\n                      <Image src={item.img || 'https://via.placeholder.com/200x200?text=No+Image'} />\r\n                      <Details>\r\n                        <ProductName>\r\n                          <b>Product:</b> {item.title}\r\n                        </ProductName>\r\n                        <ProductId>\r\n                          <b>ID:</b> {item.productId}\r\n                        </ProductId>\r\n                        {item.size && (\r\n                          <div>\r\n                            <b>Size:</b> {item.size}\r\n                          </div>\r\n                        )}\r\n                        {item.color && (\r\n                          <div>\r\n                            <b>Color:</b> {item.color}\r\n                          </div>\r\n                        )}\r\n                      </Details>\r\n                    </ProductDetail>\r\n                    <PriceDetail>\r\n                      <ProductAmountContainer>\r\n                        <QuantityButton onClick={() => handleQuantity(item.productId, item.quantity - 1)}>\r\n                          -\r\n                        </QuantityButton>\r\n                        <ProductAmount>{item.quantity}</ProductAmount>\r\n                        <QuantityButton onClick={() => handleQuantity(item.productId, item.quantity + 1)}>\r\n                          +\r\n                        </QuantityButton>\r\n                      </ProductAmountContainer>\r\n                      <ProductPrice>$ {(parseFloat(item.price) * item.quantity).toFixed(2)}</ProductPrice>\r\n                    </PriceDetail>\r\n                  </Product>\r\n                  <Hr />\r\n                </div>\r\n              ))\r\n            )}\r\n          </Info>\r\n          {cartItems.length > 0 && (\r\n            <Summary>\r\n              <SummaryTitle>ORDER SUMMARY</SummaryTitle>\r\n              <SummaryItem>\r\n                <SummaryItemText>Subtotal</SummaryItemText>\r\n                <SummaryItemPrice>$ {getTotal().toFixed(2)}</SummaryItemPrice>\r\n              </SummaryItem>\r\n              \r\n              <SummaryItem>\r\n                <SummaryItemText>\r\n                  Shipping\r\n                  {shippingInfo.hasFreeShipping && (\r\n                    <FreeShippingBadge>üöö FREE</FreeShippingBadge>\r\n                  )}\r\n                </SummaryItemText>\r\n                <SummaryItemPrice>\r\n                  {shippingInfo.hasFreeShipping ? '$ 0.00' : `$ ${shippingInfo.shipping.toFixed(2)}`}\r\n                </SummaryItemPrice>\r\n              </SummaryItem>\r\n\r\n              {!shippingInfo.hasFreeShipping && (\r\n                <SummaryItem>\r\n                  <SummaryItemText style={{ fontSize: '12px', color: '#666', fontStyle: 'italic' }}>\r\n                    Add ${(50 - getTotal()).toFixed(2)} more for free shipping!\r\n                  </SummaryItemText>\r\n                  <SummaryItemPrice></SummaryItemPrice>\r\n                </SummaryItem>\r\n              )}\r\n\r\n              <SummaryItem type=\"total\">\r\n                <SummaryItemText>Total</SummaryItemText>\r\n                <SummaryItemPrice>$ {getFinalTotal().toFixed(2)}</SummaryItemPrice>\r\n              </SummaryItem>\r\n\r\n              {showAddressForm && (\r\n                <AddressForm>\r\n                  <h3>Shipping Address</h3>\r\n                  <Input\r\n                    type=\"text\"\r\n                    name=\"street\"\r\n                    placeholder=\"Street Address\"\r\n                    value={address.street}\r\n                    onChange={handleInputChange}\r\n                    required\r\n                  />\r\n                  <InputRow>\r\n                    <InputGroup>\r\n                      <Input\r\n                        type=\"text\"\r\n                        name=\"city\"\r\n                        placeholder=\"City\"\r\n                        value={address.city}\r\n                        onChange={handleInputChange}\r\n                        required\r\n                      />\r\n                    </InputGroup>\r\n                    <InputGroup>\r\n                      <Input\r\n                        type=\"text\"\r\n                        name=\"state\"\r\n                        placeholder=\"State\"\r\n                        value={address.state}\r\n                        onChange={handleInputChange}\r\n                        required\r\n                      />\r\n                    </InputGroup>\r\n                  </InputRow>\r\n                  <InputRow>\r\n                    <InputGroup>\r\n                      <Input\r\n                        type=\"text\"\r\n                        name=\"zipCode\"\r\n                        placeholder=\"ZIP Code\"\r\n                        value={address.zipCode}\r\n                        onChange={handleInputChange}\r\n                        required\r\n                      />\r\n                    </InputGroup>\r\n                    <InputGroup>\r\n                      <Input\r\n                        type=\"text\"\r\n                        name=\"country\"\r\n                        placeholder=\"Country\"\r\n                        value={address.country}\r\n                        onChange={handleInputChange}\r\n                        required\r\n                      />\r\n                    </InputGroup>\r\n                  </InputRow>\r\n                </AddressForm>\r\n              )}\r\n\r\n              <Button \r\n                onClick={handleCheckout}\r\n                disabled={cartItems.length === 0 || isCheckingOut}\r\n              >\r\n                {isCheckingOut ? 'PROCESSING ORDER...' : \r\n                 showAddressForm ? 'PROCEED TO PAYMENT' : \r\n                 `CHECKOUT NOW ($${getFinalTotal().toFixed(2)})`}\r\n              </Button>\r\n            </Summary>\r\n          )}\r\n        </Bottom>\r\n      </Wrapper>\r\n\r\n      {/* Stripe Payment Modal */}\r\n      {showPayment && (\r\n        <PaymentModal>\r\n          <PaymentContent>\r\n            <h2 style={{ marginBottom: '10px', color: '#333' }}>Complete Your Purchase</h2>\r\n            <p style={{ fontSize: '18px', fontWeight: '600', color: '#2c5aa0', marginBottom: '20px' }}>\r\n              Total Amount: <span style={{ color: '#4CAF50' }}>${getFinalTotal().toFixed(2)}</span>\r\n            </p>\r\n            \r\n            {paymentError && <ErrorMessage>{paymentError}</ErrorMessage>}\r\n            \r\n            {clientSecret ? (\r\n              <Elements stripe={stripePromise} options={{ clientSecret }}>\r\n                <StripePaymentForm \r\n                  amount={getFinalTotal().toFixed(2)}\r\n                  clientSecret={clientSecret}\r\n                  onSuccess={handlePaymentSuccess}\r\n                  onError={handlePaymentError}\r\n                />\r\n              </Elements>\r\n            ) : (\r\n              <div>\r\n                <PayNowBtn \r\n                  onClick={handlePayment} \r\n                  disabled={isCheckingOut}\r\n                >\r\n                  {isCheckingOut ? 'Setting Up Payment...' : 'Proceed to Payment'}\r\n                </PayNowBtn>\r\n              </div>\r\n            )}\r\n            \r\n            <CancelBtn onClick={() => {\r\n              setShowPayment(false);\r\n              setClientSecret('');\r\n              setPaymentError('');\r\n            }}>\r\n              Cancel Payment\r\n            </CancelBtn>\r\n          </PaymentContent>\r\n        </PaymentModal>\r\n      )}\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default CartPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}